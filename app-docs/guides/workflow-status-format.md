# Workflow Status Format

Use this guide when emitting structured workflow status updates from slash commands.

## Directory Layout
- Status updates live in `ai-docs/capabilities/<capability-id>/workflow/`.
- Each command writes a separate JSON file named `<iso-timestamp>-<phase>.json`.
- The sync script aggregates the latest file per feature into `ai-docs/capabilities/status-index.json`.

## File Schema
Each status JSON file must include the following fields:

| Field | Type | Description |
| --- | --- | --- |
| `featureId` | string | Lowercase kebab-case identifier derived from the capability or plan title. Must match the directory name. |
| `featureTitle` | string | Human-readable capability name shown on the dashboard. |
| `phase` | string | Current workflow phase (`product-charter`, `capability-catalog`, `wishlist`, `product-research`, `dependency-plan`, `breakout-plan`, `execution-prep`, `discovery`, `plan`, `build`, `verification`, `deployment`, `ops-coordination`, `provider-functions`, `support-feedback`, etc.). |
| `status` | string | State within the phase (`pending`, `in_progress`, `needs_docs`, `needs_validation`, `blocked`, `failed`, `completed`). |
| `command` | string | Slash command that produced this update. |
| `nextCommand` | string | Ready-to-run follow-up command for the user. Leave an empty string if no immediate action. |
| `summary` | string | One-sentence status summary (<= 140 characters). |
| `outputPath` | string | Primary artifact path generated by the command (plan file, build log, report, etc.). |
| `documentation` | array<string> | Paths to documentation that should be updated or reviewed. |
| `timestamp` | string | ISO-8601 timestamp for when the command completed. |

### Optional Fields
- `notes`: additional guidance for the user.
- `validation`: structure describing blockers or validation failures (object).
- `checks`: array of tests or verifications that ran.

## Example
```json
{
  "featureId": "add-auth-guard",
  "featureTitle": "Add Auth Guard",
  "phase": "plan",
  "status": "needs_validation",
  "command": "/baw_dev_plan \"Add Auth Guard\" \"\" \"ai-docs/capabilities/add-auth-guard/intake/requirements.md\"",
  "nextCommand": "/baw_dev_plan \"Add Auth Guard\" --resume",
  "summary": "Plan drafted and waiting for validation feedback.",
  "outputPath": "ai-docs/capabilities/add-auth-guard/plans/20250112-add-auth-guard/plan.md",
  "documentation": [
    "app-docs/specs/active/add-auth-guard.md"
  ],
  "timestamp": "2025-01-12T18:33:02.000Z",
  "notes": "Fill in missing API contract before resuming build."
}
```

## Slugging Rules
- Convert capability titles to lowercase.
- Replace spaces and punctuation with hyphens.
- Remove characters outside `[a-z0-9-]`.
- Collapse consecutive hyphens.

## Dashboards
- `node scripts/update-workflow-status.js` aggregates per-capability updates.
- `npm run baw:work` renders the unified dashboard and shows the latest status + resume commands.
- `npm run baw:session:start` highlights token usage and suggested follow-ups.

## Recommended Phase Names
Use the following canonical values when possible so dashboards can group initiatives consistently:

- `product-charter`, `capability-catalog`, `wishlist`, `product-research`
- `dependency-plan`, `breakout-plan`, `execution-prep`, `discovery`, `plan`
- `build`, `verification`, `deployment`
- `ops-coordination`, `provider-functions`, `support-feedback`
- Legacy phases such as `test`, `report`, `release` remain valid for existing automation.

Keep every command’s status JSON concise and machine-parseable so automation can run without manual bookkeeping—`npm run baw:workflow:sync` will handle aggregation automatically.
