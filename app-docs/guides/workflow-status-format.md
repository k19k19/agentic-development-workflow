# Workflow Status Format

Use this guide when emitting structured workflow status updates from slash commands.

## Directory Layout
- Status updates live in `ai-docs/workflow/<feature-id>/`.
- Each command writes a separate JSON file named `<iso-timestamp>-<phase>.json`.
- The sync script aggregates the latest file per feature into `ai-docs/workflow/status-index.json`.

## File Schema
Each status JSON file must include the following fields:

| Field | Type | Description |
| --- | --- | --- |
| `featureId` | string | Lowercase kebab-case identifier derived from the feature or plan title. Must match the directory name. |
| `featureTitle` | string | Human-readable feature name shown on the dashboard. |
| `phase` | string | Current workflow phase (`scout`, `plan`, `build`, `report`, `test`, etc.). |
| `status` | string | State within the phase (`pending`, `in_progress`, `needs_docs`, `needs_validation`, `blocked`, `failed`, `completed`). |
| `command` | string | Slash command that produced this update. |
| `nextCommand` | string | Ready-to-run follow-up command for the user. Leave an empty string if no immediate action. |
| `summary` | string | One-sentence status summary (<= 140 characters). |
| `outputPath` | string | Primary artifact path generated by the command (plan file, build log, report, etc.). |
| `documentation` | array<string> | Paths to documentation that should be updated or reviewed. |
| `timestamp` | string | ISO-8601 timestamp for when the command completed. |

### Optional Fields
- `notes`: additional guidance for the user.
- `validation`: structure describing blockers or validation failures (object).
- `checks`: array of tests or verifications that ran.

## Example
```json
{
  "featureId": "add-auth-guard",
  "featureTitle": "Add Auth Guard",
  "phase": "plan",
  "status": "needs_validation",
  "command": "/plan \"Add Auth Guard\" \"\" \"ai-docs/scout/add-auth-guard/context.md\"",
  "nextCommand": "/plan \"Add Auth Guard\" --resume",
  "summary": "Plan drafted and waiting for validation feedback.",
  "outputPath": "ai-docs/plans/20250112-add-auth-guard/plan.md",
  "documentation": [
    "app-docs/specs/active/add-auth-guard.md"
  ],
  "timestamp": "2025-01-12T18:33:02.000Z",
  "notes": "Fill in missing API contract before resuming build."
}
```

## Slugging Rules
- Convert feature titles to lowercase.
- Replace spaces and punctuation with hyphens.
- Remove characters outside `[a-z0-9-]`.
- Collapse consecutive hyphens.

## Dashboards
- `node scripts/update-workflow-status.js` aggregates per-feature updates.
- `npm run work` renders the unified dashboard and shows the latest status + resume commands.

Keep every command’s status JSON concise and machine-parseable so automation can run without manual bookkeeping—`npm run workflow:sync` will handle aggregation automatically.
